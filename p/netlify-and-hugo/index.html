<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="nextlify部署hugo blog 参考： hugo官方: https://gohugo.io/hosting-and-deployment/hosting-on-netlify nextlify官方: https://docs.netlify.com/integrations/frameworks/hugo/ 步骤 上传项目到github仓库, 该仓库可以是私人仓库 hugo的主"><title>使用netlify部署hugo注意事项</title><link rel=canonical href=/p/netlify-and-hugo/><link rel=stylesheet href=/scss/style.min.6dae1168bc4b4544b76ba60ac495427d4659a7b8dccf264a0712326e3565d2ba.css><meta property="og:title" content="使用netlify部署hugo注意事项"><meta property="og:description" content="nextlify部署hugo blog 参考： hugo官方: https://gohugo.io/hosting-and-deployment/hosting-on-netlify nextlify官方: https://docs.netlify.com/integrations/frameworks/hugo/ 步骤 上传项目到github仓库, 该仓库可以是私人仓库 hugo的主"><meta property="og:url" content="/p/netlify-and-hugo/"><meta property="og:site_name" content="Jqtmviyu's Blog"><meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:tag" content="hugo"><meta property="article:tag" content="netlify"><meta property="article:published_time" content="2020-02-28T00:00:00+00:00"><meta property="article:modified_time" content="2022-12-20T00:00:00+00:00"><meta name=twitter:title content="使用netlify部署hugo注意事项"><meta name=twitter:description content="nextlify部署hugo blog 参考： hugo官方: https://gohugo.io/hosting-and-deployment/hosting-on-netlify nextlify官方: https://docs.netlify.com/integrations/frameworks/hugo/ 步骤 上传项目到github仓库, 该仓库可以是私人仓库 hugo的主"><link rel="shortcut icon" href=/favicon.png></head><body class=article-page><script>(function(){const a='StackColorScheme';localStorage.getItem(a)||localStorage.setItem(a,"auto")})()</script><script>(function(){const b='StackColorScheme',a=localStorage.getItem(b),c=window.matchMedia('(prefers-color-scheme: dark)').matches===!0;a=='dark'||a==='auto'&&c?document.documentElement.dataset.scheme='dark':document.documentElement.dataset.scheme='light'})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu5dc921b5916569d953912c0faaa2a3c2_62047_300x0_resize_box_2.png width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>Jqtmviyu's Blog</a></h1><h2 class=site-description>It's never too late to learn.</h2></div></header><ol class=social-menu><li><a href=https://github.com/jqtmviyu target=_blank title=GitHub rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=mailto:jqtmviyu@gmail.com target=_blank title=Mail rel=me><!doctype html><svg t="1640862754493" class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" p-id="1236" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><defs><style/></defs><path d="M858.656 192H165.344C109.472 192 64 237.44 64 293.312v469.376C64 818.56 109.472 864 165.344 864h693.312C914.528 864 960 818.56 960 762.688V293.312C960 237.44 914.528 192 858.656 192zm0 608H165.344C144.736 8e2 128 783.264 128 762.688V293.312C128 272.736 144.736 256 165.344 256h684.544L542.4 535.808c-14.592 14.56-38.272 14.528-54.752-1.792L243.392 327.264C229.856 315.84 209.664 317.504 198.272 331.008c-11.424 13.472-9.76 33.664 3.744 45.088l242.304 204.96c19.904 19.904 46.048 29.792 72.032 29.792 25.632.0 51.136-9.632 70.176-28.736L896 300.544v462.144C896 783.264 879.264 8e2 858.656 8e2z" p-id="1237" fill="#b6b6b6"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>Home</span></a></li><li><a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg><span>Archives</span></a></li><li><a href=/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg><span>Search</span></a></li><li><a href=/links/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg><span>Links</span></a></li><div class=menu-bottom-section><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>Dark Mode</span></li></div></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#步骤>步骤</a></li><li><a href=#可选-绑定域名>可选: 绑定域名</a></li><li><a href=#可能的问题>可能的问题</a></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/notes/>notes</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/netlify-and-hugo/>使用netlify部署hugo注意事项</a></h2></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>2020/Feb/28</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>2 minute read</time></div></footer></div></header><section class=article-content><h1 id=nextlify部署hugo-blog>nextlify部署hugo blog</h1><p>参考：</p><p>hugo官方: <a href=https://gohugo.io/hosting-and-deployment/hosting-on-netlify>https://gohugo.io/hosting-and-deployment/hosting-on-netlify</a></p><p>nextlify官方: <a href=https://docs.netlify.com/integrations/frameworks/hugo/>https://docs.netlify.com/integrations/frameworks/hugo/</a></p><h2 id=步骤>步骤</h2><ol><li><p>上传项目到github仓库, 该仓库可以是私人仓库</p></li><li><p>hugo的主题必须是<code>git submodule</code>形式, 如果自定义主题, 上传到gihub仓库上, 以子模块方式引入</p></li><li><p>在<code>.gitignore</code>里排除 <code>public</code>文件夹</p></li><li><p>在项目根目录下新建文件<code>netlify.toml</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-toml data-lang=toml><span class=p>[</span><span class=nx>build</span><span class=p>]</span>
<span class=nx>publish</span> <span class=p>=</span> <span class=s2>&#34;public&#34;</span>
<span class=nx>command</span> <span class=p>=</span> <span class=s2>&#34;hugo --gc --minify&#34;</span>
   
<span class=p>[</span><span class=nx>context</span><span class=p>.</span><span class=nx>production</span><span class=p>.</span><span class=nx>environment</span><span class=p>]</span>
<span class=nx>HUGO_VERSION</span> <span class=p>=</span> <span class=s2>&#34;0.65.3&#34;</span>
<span class=nx>HUGO_ENV</span> <span class=p>=</span> <span class=s2>&#34;production&#34;</span>
<span class=nx>HUGO_ENABLEGITINFO</span> <span class=p>=</span> <span class=s2>&#34;true&#34;</span>
   
<span class=p>[</span><span class=nx>context</span><span class=p>.</span><span class=nx>split1</span><span class=p>]</span>
<span class=nx>command</span> <span class=p>=</span> <span class=s2>&#34;hugo --gc --minify --enableGitInfo&#34;</span>
   
<span class=p>[</span><span class=nx>context</span><span class=p>.</span><span class=nx>split1</span><span class=p>.</span><span class=nx>environment</span><span class=p>]</span>
<span class=nx>HUGO_VERSION</span> <span class=p>=</span> <span class=s2>&#34;0.65.3&#34;</span>
<span class=nx>HUGO_ENV</span> <span class=p>=</span> <span class=s2>&#34;production&#34;</span>
   
<span class=p>[</span><span class=nx>context</span><span class=p>.</span><span class=nx>deploy</span><span class=err>-</span><span class=nx>preview</span><span class=p>]</span>
<span class=nx>command</span> <span class=p>=</span> <span class=s2>&#34;hugo --gc --minify --buildFuture -b $DEPLOY_PRIME_URL&#34;</span>
   
<span class=p>[</span><span class=nx>context</span><span class=p>.</span><span class=nx>deploy</span><span class=err>-</span><span class=nx>preview</span><span class=p>.</span><span class=nx>environment</span><span class=p>]</span>
<span class=nx>HUGO_VERSION</span> <span class=p>=</span> <span class=s2>&#34;0.65.3&#34;</span>
   
<span class=p>[</span><span class=nx>context</span><span class=p>.</span><span class=nx>branch</span><span class=err>-</span><span class=nx>deploy</span><span class=p>]</span>
<span class=nx>command</span> <span class=p>=</span> <span class=s2>&#34;hugo --gc --minify -b $DEPLOY_PRIME_URL&#34;</span>
   
<span class=p>[</span><span class=nx>context</span><span class=p>.</span><span class=nx>branch</span><span class=err>-</span><span class=nx>deploy</span><span class=p>.</span><span class=nx>environment</span><span class=p>]</span>
<span class=nx>HUGO_VERSION</span> <span class=p>=</span> <span class=s2>&#34;0.65.3&#34;</span>
   
<span class=p>[</span><span class=nx>context</span><span class=p>.</span><span class=nx>next</span><span class=p>.</span><span class=nx>environment</span><span class=p>]</span>
<span class=nx>HUGO_ENABLEGITINFO</span> <span class=p>=</span> <span class=s2>&#34;true&#34;</span>
</code></pre></td></tr></table></div></div></li><li><p>注册Nextlify，可以用github账号授权</p></li><li><p>选择<code> “New site from Git”——“Github”——选择自己hugo博客源码对应的仓库</code></p></li><li><p>在<code>Deploy</code>之前可以先设置下, <code>"site overview"--"site setting"--"change site name"</code>, 不改的话会默认分配<code>https://xxx-xxx-xxx.netlify.app</code>一堆符号的二级域名</p></li><li><p><code>Deploy status badge</code>徽章可以放到项目的readme上, 可以看到最新部署状态</p></li><li><p>Deploy</p></li><li><p>每次仓库更新, netlify就会自动部署</p></li></ol><h2 id=可选-绑定域名>可选: 绑定域名</h2><ol><li><code>Site settings -- Domain management--Custom domains--Add domain alias--填写域名--verify--Yes,add domain</code></li><li>填写后到DNS 解析提供商里面，将 CNAME 记录值更改为 Netlify 给你的二级域名</li><li>https: 隔一段时间后点<code>Verify DNS configuration</code></li></ol><h2 id=可能的问题>可能的问题</h2><ol><li>报错：</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>Production: master@HEAD Failed
failed during stage <span class=s1>&#39;building site&#39;</span>: Build script returned non-zero <span class=nb>exit</span> code: <span class=m>255</span>
<span class=c1># 解决方法: stackoverflow上找到类似答案，需要修改Netlify控制台的环境变量与实际Hugo版本一致。</span>
<span class=c1># 技术问题千万别用百度，垃圾csdn</span>
<span class=c1># hugo -v</span>
</code></pre></td></tr></table></div></div><p><code>“setting”——“Build&deploy”——“Environment”——"Environment variables"——“Edit variables”，左边填“HUGO_VERSION”，右边填“v?.?.?”</code>。</p><p>注：版本号以实际为准</p><ol start=2><li><p>报错</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>The build image <span class=k>for</span> this site uses Ubuntu 16.04 Xenial Xerus, which is no longer supported.
<span class=c1># ubuntu 版本过低</span>
</code></pre></td></tr></table></div></div><p><code>"Deploys"--"Delploy settings"--"Build image selection"--"Edit settings"--选最新的</code></p><p>重新部署</p></li></ol></section><footer class=article-footer><section class=article-tags><a href=/tags/hugo/>hugo</a>
<a href=/tags/netlify/>netlify</a></section><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span><a rel=license href=http://creativecommons.org/licenses/by-nc-sa/4.0/>LICENSED UNDER CC BY-NC-SA 4.0<br></a></span></section><section class=article-lastmod><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><span>Last updated on 2022/Dec/20 00:00 UTC</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/p/hugo-theme-bug/><div class=article-details><h2 class=article-title>hugo主题stack侧边栏bug</h2></div></a></article><article><a href=/p/github-page-blog/><div class=article-details><h2 class=article-title>用Github Page 搭免费博客</h2></div></a></article><article><a href=/p/clean-macos-system-data/><div class=article-details><h2 class=article-title>MacOs清理System Data</h2></div></a></article><article><a href=/p/npm/><div class=article-details><h2 class=article-title>Nginx Proxy Manager</h2></div></a></article><article><a href=/p/n2n-deploy/><div class=article-details><h2 class=article-title>n2n部署</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2017 -
2022 Jqtmviyu's Blog</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.16.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script><script>(function(){const a=document.createElement('link');a.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",a.type="text/css",a.rel="stylesheet",document.head.appendChild(a)})()</script></body></html>